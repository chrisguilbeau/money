<head>
  <title>Money</title>
  <meta name="viewport" content="width=200, user-scalable=no">
  <link rel="apple-touch-icon" href="apple-touch-icon.png"/>
</head>

<body>
  <div class='loader'></div>
  <div class='main'>
    {{> main}}
    <hr>
    {{loginButtons}}
  </div>
</body>

<template name="main">
	{{#if authenticated}}
      <hr>
      <div class="progress-out">
        <div class="progress-in" style="width:{{percentPeriodElapsed}}%;"></div>
        <div class="daysLeftInPeriod">
          <span>{{daysLeftInPeriod}} days left, ${{totalLeftForPeriod}} to spend</span>
        </div>
      </div>
      <hr>
  		{{#each categories}}
        <div class="progress-out">
          <div class="progress-in" style="width:{{percentSpent _id}}%;"></div>
          {{#if isAdminMode}}
            <div class="cell tight">
              <button class="delete" dbid="{{_id}}" >x</button>
            </div>
          {{/if}}
            <div class="cell">
              <input type="text" pattern="[0-9]*" dbid="{{_id}}" placeholder="{{name}} ${{catTotal _id}}" balance="{{catTotal _id}}"/>
            </div>
          {{#if isAdminMode}}
            <div class="cell tight">
              <button class="add" dbid="{{_id}}" >+</button>
            </div>
          {{/if}}
          <div class="cell tight">
            <button class="spend" dbid="{{_id}}" >$</button>
          </div>
        </div>
  			<hr>
  		{{/each}}
		  {{#if isAdminMode}}
	  		<input type="text" id="new_category" placeholder="New Category" />
  			<button id="add_new_category">Add</button>
  			<hr>
  		{{/if}}
  		<input type="checkbox" id="toggle_admin" {{#if isAdminMode}}checked="checked"{{/if}} />
  		<label>Admin Mode</label>
      <table id="txns"><tbody>
      {{#each transactions}}
        <tr><td>{{formatTime timestamp}}</td><td>{{getCategory catId}}</td><td class="right">$</td><td class="right">{{amount}}</td></tr>
      {{/each}}
      </tbody></table>
  {{/if}}
</template>
